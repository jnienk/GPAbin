#utility functions
df2fact <- function (in.df, ordered=FALSE)
{
  ###############################################################################################
  ###############################################################################################
  #Information
  #This function transforms each column of a data.frame into unordered factor #variables (ordered=F) or ordered factor variables (ordered=T)
  ###############################################################################################
  #Arugments
  #"in.df" a data.frame containing factors
  #"ordered" if TRUE (T) factor levels are ordered, if FALSE (F) factor levels are #unordered
  ###############################################################################################
  #Value
  #Returns a transformed data.frame according to "ordered" argument.
  ###############################################################################################
  ###############################################################################################
  out.df <- factor(in.df[,1],ordered=ordered)
  
  for(i in 2:ncol(in.df)) out.df <- data.frame(out.df, factor(in.df[,i], ordered=ordered))
  
  colnames(out.df) <- colnames(in.df)
  rownames(out.df) <- rownames(in.df)
  return(out.df)
}
###################################################################################
###################################################################################
FormatImpList <- function (mylist)
{
  ###################################################################################
  ###################################################################################
  #Information
  #This function adds names to elements of the list containing the imputations
  ###################################################################################
  #Arguments
  #"mylist" is a list containing MIs
  ###################################################################################
  #Value
  #Returns formatted "mylist"
  ###################################################################################
  ###################################################################################
  imp <- length(mylist)
  names(mylist) <- paste('Imputation',1:imp,sep='.')
  return(mylist)
}
###################################################################################
###################################################################################
rmOneCL <- function(inlist)
{
  ###################################################################################
  ###################################################################################
  #Information
  #This function removes columns with only one CL before applying MCA
  ###################################################################################
  #Arguments
  #"inlist" list of factor objects
  ###################################################################################
  #Value
  #Returns the input list, now with removed columns
  ###################################################################################
  ###################################################################################
  M <- length(inlist)
  
  for(m in 1:M)
  {
    dat <- inlist[[m]]
    pvar <- ncol(dat)
    vecel <- vector("numeric",pvar)
    for (i in 1:pvar)
    {
      if(length(levels(dat[,i]))==1)
        vecel[i] <- i
    }
    if(sum(vecel)==0)
    {
      inlist[[m]] <- dat
    } else
    {
      vecel <- vecel[vecel != 0]
      inlist[[m]] <- dat[,-vecel]
    }
  }
  return(inlist)
}
###################################################################################
rmOneCLjom <- function(inlist)
{
  ###################################################################################
  ###################################################################################
  #Information
  #This function removes columns with only one CL before applying MCA specifically for output from jomo
  ###################################################################################
  #Arguments
  #"inlist" list of factor objects
  ###################################################################################
  #Value
  #Returns the input list, now with removed columns
  ###################################################################################
  ###################################################################################
  M <- length(inlist)
  
  for(m in 1:M)
  {
    dat <- inlist[[m]][,1:5]
    pvar <- ncol(dat)
    vecel <- vector("numeric",pvar)
    for (i in 1:pvar)
    {
      if(length(levels(dat[,i]))==1)
        vecel[i] <- i
    }
    if(sum(vecel)==0)
    {
      inlist[[m]] <- dat
    } else
    {
      vecel <- vecel[vecel != 0]
      inlist[[m]] <- dat[,-vecel]
    }
  }
  return(inlist)
}
###################################################################################
###################################################################################
is.integer0 <- function(x)
{
  ###################################################################################
  ###################################################################################
  #Information
  #This function detects integers with zero length
  #This function is used as a precaution to eliminate possible errors
  ###################################################################################
  #Argument
  #"x" scalar value
  ###################################################################################
  #Value
  #Returns a TRUE or FALSE
  ###################################################################################
  ###################################################################################
  is.integer(x) && length(x) == 0L
}

###################################################################################
###################################################################################

delCL <- function(data)
{
  ###################################################################################
  ###################################################################################
  #Information
  #This function removes empty factor levels
  ###################################################################################
  #Arguments
  #"data" is an object of the factor class
  ###################################################################################
  #Value
  #"Returns the input object, now with empty category levels removed
  ###################################################################################
  ###################################################################################
  for (j in 1:ncol(data))
  {
    col <- data[,j]
    nl <- levels(col)
    
    for (i in 1:length(nl))
    {
      col <- droplevels(col,exclude=NA)
    }
    data[,j] <- col
  }
  return(data)
}

###################################################################################
